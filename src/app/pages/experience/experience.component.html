<section id="experience" class="py-20 bg-dark-900 border-t border-dark-700 overflow-hidden relative">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">

        <!-- Header -->
        <div class="text-center mb-20">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">My Journey</h2>
            <p class="text-gray-400">A timeline of my {{ totalExperience }}+ years of professional and academic
                milestones.</p>
        </div>

        <!-- Unified Timeline Container -->
        <div class="relative">

            <!-- Central Spine (Vertical Line) -->
            <div class="absolute left-1/2 top-0 bottom-0 w-0.5 bg-dark-700 -translate-x-1/2 hidden md:block"></div>

            <!-- Timeline Items -->
            <div class="space-y-12 md:space-y-24">
                <div *ngFor="let item of mergedTimeline; let i = index"
                    class="relative flex flex-col md:flex-row items-center gap-8 md:gap-16 group"
                    [class.md:flex-row-reverse]="i % 2 !== 0">

                    <!-- Year/Date (Center - Desktop) -->
                    <div class="hidden md:flex absolute left-1/2 top-0 -translate-x-1/2 justify-center z-20 w-32">
                        <div
                            class="bg-dark-900 border-2 border-primary text-primary px-4 py-1 rounded-full text-sm font-bold shadow-[0_0_15px_rgba(99,102,241,0.3)] whitespace-nowrap z-20 relative">
                            {{ item.date }}
                        </div>
                    </div>

                    <!-- Content Card -->
                    <div class="w-full md:w-[calc(50%-4rem)]" [class.md:text-right]="i % 2 === 0"
                        [class.md:text-left]="i % 2 !== 0">
                        <div
                            class="relative bg-dark-800 p-6 md:p-8 rounded-3xl border border-dark-700 hover:border-primary/50 transition-all duration-300 hover:-translate-y-2 shadow-xl group-hover:shadow-[0_10px_30px_-10px_rgba(99,102,241,0.2)]">

                            <!-- Mobile Date Badge (Inside Card) -->
                            <div class="md:hidden mb-4 inline-block">
                                <span
                                    class="bg-dark-900 border border-primary/30 text-primary px-3 py-1 rounded-full text-xs font-bold">
                                    {{ item.date }}
                                </span>
                            </div>

                            <!-- Horizontal Connector Line (From Spine to Card - Desktop) -->
                            <div class="absolute top-8 h-0.5 bg-dark-700 hidden md:block w-[4.5rem]"
                                [class.right-[-4.5rem]]="i % 2 === 0" [class.left-[-4.5rem]]="i % 2 !== 0">
                            </div>

                            <!-- Connector Dot (On Card Edge - Desktop) -->
                            <div class="absolute top-8 w-4 h-4 rounded-full border-4 border-dark-900 z-10 
                                        bg-current shadow-lg hidden md:block" [ngClass]="{
                                    'text-primary': item.type === 'work',
                                    'text-purple-500': item.type !== 'work',
                                    '-translate-x-1/2': i % 2 !== 0,
                                    'translate-x-1/2': i % 2 === 0,
                                    'right-[-4px]': i % 2 !== 0,
                                    'left-[-4px]': i % 2 === 0
                                 }" [style.left]="i % 2 !== 0 ? '-3px' : 'auto'"
                                [style.right]="i % 2 === 0 ? '-3px' : 'auto'">
                            </div>

                            <!-- Header: Icon & Badge Flex Container -->
                            <div class="flex items-start justify-between mb-4" [class.md:flex-row-reverse]="i % 2 === 0"
                                [class.md:flex-row]="i % 2 !== 0">

                                <!-- Icon -->
                                <div class="inline-flex items-center justify-center w-10 h-10 rounded-xl shrink-0"
                                    [ngClass]="item.type === 'work' ? 'bg-primary/20 text-primary' : 'bg-purple-500/20 text-purple-400'"
                                    title="{{ item.type === 'work' ? 'Work Experience' : 'Education' }}">
                                    <lucide-icon [name]="item.type === 'work' ? 'briefcase' : 'graduation-cap'"
                                        class="w-5 h-5"></lucide-icon>
                                </div>

                                <!-- Type Badge -->
                                <span
                                    class="px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide border shrink-0"
                                    [ngClass]="item.type === 'work' ? 'bg-primary/5 text-primary border-primary/20' : 'bg-purple-500/5 text-purple-400 border-purple-500/20'">
                                    {{ item.type === 'work' ? 'Work' : 'Education' }}
                                </span>
                            </div>

                            <h3 class="text-xl md:text-2xl font-bold text-white mb-1">{{ item.role }}</h3>
                            <h4 class="text-base md:text-lg text-gray-400 mb-4 font-medium"
                                title="{{ item.organization }}">{{
                                item.organization }}</h4>
                            <p class="text-gray-400 leading-relaxed text-sm md:text-base">{{ item.description }}</p>

                        </div>
                    </div>

                    <!-- Empty space for opposite side -->
                    <div class="hidden md:block md:w-[calc(50%-4rem)]"></div>

                </div>
            </div>

        </div>
    </div>
</section>